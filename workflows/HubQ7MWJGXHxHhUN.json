{
  "active": false,
  "connections": {
    "Get Sitemap": {
      "main": [
        [
          {
            "node": "XML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract URLs": {
      "main": [
        []
      ]
    },
    "Filter Product URLs": {
      "main": [
        [
          {
            "node": "Get Product Page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Product Page": {
      "main": [
        [
          {
            "node": "Extract URLs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Post to WordPress",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Content": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Test workflow’": {
      "main": [
        [
          {
            "node": "Get Sitemap",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract URLs1": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Extract Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "XML": {
      "main": [
        [
          {
            "node": "Filter Product URLs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Product URLs1": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Filter Product URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-05-23T19:56:49.195Z",
  "id": "HubQ7MWJGXHxHhUN",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "My workflow 2",
  "nodes": [
    {
      "parameters": {
        "url": "https://xachtaynhat.net/sitemap.xml",
        "responseFormat": "string",
        "options": {}
      },
      "id": "601c754a-e379-4593-b7a5-6ac2fb3ca64c",
      "name": "Get Sitemap",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        160,
        -20
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "10335b5b-30f4-41e0-91cb-7e07034cbd66",
      "name": "Extract URLs",
      "type": "n8n-nodes-base.xml",
      "typeVersion": 1,
      "position": [
        380,
        160
      ]
    },
    {
      "parameters": {
        "functionCode": "// Giả sử đây là dữ liệu đầu vào của items (trong n8n Function Node)\nconst sitemapData = items[0].json.sitemapindex.sitemap;\n\n// Lọc ra các URL có chứa 'product-sitemap.xml'\nconst filteredProductSitemap = sitemapData.filter(item => item.loc.includes('product-sitemap.xml'));\n\n// Chuyển kết quả về định dạng n8n items (nếu có nhiều URL cùng kiểu này)\nreturn filteredProductSitemap.map(item => {\n  return {\n    json: {\n      product_sitemap_url: item.loc,\n      lastmod: item.lastmod\n    }\n  };\n});"
      },
      "id": "a4cc4752-2f49-4150-9af5-06ad7c91c695",
      "name": "Filter Product URLs",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1920,
        -20
      ]
    },
    {
      "parameters": {
        "url": "={{ $json.product_sitemap_url }}",
        "responseFormat": "string",
        "options": {}
      },
      "id": "cf7870db-9225-4e6f-8b27-9cc9574c43f7",
      "name": "Get Product Page",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        2080,
        -20
      ]
    },
    {
      "parameters": {
        "functionCode": "const cheerio = require('cheerio');\nconst $ = cheerio.load($json['body']);\nreturn [{\n    json: {\n        title: $('h1').text(),\n        description: $('meta[name=\"description\"]').attr('content'),\n        content: $('.product-description').text(),\n        keywords: $('meta[name=\"keywords\"]').attr('content')\n    }\n}];"
      },
      "id": "b29491b7-0f8d-4905-b0a1-88bc8c61b605",
      "name": "Extract Content",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        2600,
        340
      ]
    },
    {
      "parameters": {
        "url": "https://example.com/wp-json/wp/v2/posts",
        "jsonParameters": true,
        "options": {}
      },
      "id": "b578df57-534c-4b59-b25a-c3da4356de9c",
      "name": "Post to WordPress",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        3080,
        -140
      ]
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -20,
        -20
      ],
      "id": "d2eff4b1-a908-4676-8135-4a1ceeb91659",
      "name": "When clicking ‘Test workflow’"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        2640,
        -180
      ],
      "id": "8de31813-9e1f-4916-85c1-e939ac793a5f",
      "name": "AI Agent"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        2840,
        0
      ],
      "id": "3e0f89bf-191c-4904-806e-1ebf6173128d",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "modelName": "models/gemini-1.5-flash-002",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        2680,
        80
      ],
      "id": "968929c4-344c-4542-a066-26ab1cc0d340",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "liF9LQ41TU5GXcpB",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "01e6e9c2-6f45-419b-ae43-38bcafc2c449",
      "name": "Extract URLs1",
      "type": "n8n-nodes-base.xml",
      "typeVersion": 1,
      "position": [
        1940,
        220
      ]
    },
    {
      "parameters": {
        "url": "={{ $json.urlset.url[0].loc }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2160,
        220
      ],
      "id": "8ca95987-ebc0-46b7-8714-44c5aceb8c14",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "options": {
          "ignoreAttrs": true,
          "mergeAttrs": true,
          "normalize": true,
          "trim": true
        }
      },
      "type": "n8n-nodes-base.xml",
      "typeVersion": 1,
      "position": [
        380,
        -20
      ],
      "id": "2b10648a-05f7-48c3-932d-4344d7125096",
      "name": "XML"
    },
    {
      "parameters": {
        "functionCode": "// Giả sử input là items[0] từ HTTP Request sitemap index\nconst sitemapData = items[0].json.sitemapindex.sitemap;\n\n// Lọc các sitemap con có chứa 'product-sitemap'\nconst filtered = sitemapData.filter(item => item.loc.includes('product-sitemap'));\n\nreturn filtered.map(item => ({\n  json: { sitemap_url: item.loc }\n}));"
      },
      "id": "6a441b1f-31d4-4b08-87f8-fced5e8a67c1",
      "name": "Filter Product URLs1",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        580,
        -20
      ]
    },
    {
      "parameters": {
        "jsCode": "const xml2js = require('xml2js');\nconst parser = new xml2js.Parser();\nconst xml = $json[\"response\"]; // nội dung XML\n\nlet result = await parser.parseStringPromise(xml);\n\n// Xử lý trường hợp không có url\nif (!result.urlset || !result.urlset.url) {\n  return [];\n}\n\nconst urls = result.urlset.url.map(u => u.loc[0]);\n\n// Trả về n8n items\nreturn urls.map(url => ({\n  json: { product_url: url }\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1000,
        -80
      ],
      "id": "d1dd93a5-aa7e-4f73-a7b3-67e0b6fb1bdd",
      "name": "Code"
    },
    {
      "parameters": {
        "url": "={{ $json.sitemap_url }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        -20
      ],
      "id": "a6dfa5c0-de75-4c3c-880e-6a7fedc217be",
      "name": "HTTP Request1"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-05-23T19:56:49.198Z",
      "updatedAt": "2025-05-23T19:56:49.198Z",
      "role": "workflow:owner",
      "workflowId": "HubQ7MWJGXHxHhUN",
      "projectId": "quf7HR2xEtUzOS9Z"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-05-27T20:36:05.000Z",
  "versionId": "6f1f3cfa-057f-4549-84a8-aa2da4c606f0"
}